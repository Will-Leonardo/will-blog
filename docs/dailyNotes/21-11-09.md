---
title:  2021-11-9
date: 2021-11-9
---

<Boxx type='tip' />

##  /deep/ 和 ::v-deep 

场景： [使用深度作用选择器 /deep/修改 element-ui iview 框架自带样式](https://blog.csdn.net/qq_38128179/article/details/100919337)


## Cannot find module 'xxx'

1, 检查路径

2, 检查模块是否存在

3, 将项目放倒vscode工作区的根目录
 
## vue 路由传参
参考文章： [Vue 路由组件传参的 8 种方式](https://segmentfault.com/a/1190000039398462)
传递参数分为 **query**、和**params** 两种

:chestnut: 例子：

1， 传参
```js
this.$router.push{
    name: 'TestPage',
    query: {
        id: this.booksId
    },
    params:{
        bookName: this.bookName
    }
}
```

2，接受参数

testpage页面
**注意** 是 $route、不是$router
```js
console.log(this.$route.query.id)   //  id
console.log(this.$route.params.bookName)  // bookName
```

3，改变传参和接受参数的方式

```js
routes: [
    { path: '/', component: Hello }, // No props, no nothing
    { path: '/hello/:name', component: Hello, props: true }, // Pass route.params to props
    { path: '/static', component: Hello, props: { name: 'world' }}, // static values
    { path: '/dynamic/:years', component: Hello, props: dynamicPropsFn }, // custom logic for mapping between route and props
    { path: '/attrs', component: Hello, props: { name: 'attrs' }}
  ]
```

接收： **props: true 可以将 route.params 转成 props**
testpage页面
```js
props:{
    bookName: string
}
```
4，特别注意：
query 会写在url里面，强制刷新不丢失；     
params 强制刷新将丢失；

## 深入理解定位父级offsetParent及偏移大小offset
参考：[深入理解定位父级offsetParent及偏移大小](https://www.cnblogs.com/xiaohuochai/p/5828369.html)
- offsetParent : 偏移父级
- offsetLeft : offsetLeft表示元素的左外边框至offsetParent元素的左内边框之间的像素距离
- offsetTop : offsetTop表示元素的上外边框至offsetParent元素的上内边框之间的像素距离
- offsetWidth : border-left-width + padding-left + width + padding-right + border-right-width; 
- offsetHeight :  border-top-width + padding-top + height + padding-bottom + border-bottom-width

页面偏移：

```js
function getElementLeft(element){
    var actualLeft = element.offsetLeft;
    var current = element.offsetParent;
    while(current != null){
        actualLeft += current.offsetLeft + current.clientLeft;
        current = current.offsetParent;
    }
    return actualLeft + 'px';
}
function getElementTop(element){
    var actualTop = element.offsetTop;
    var current = element.offsetParent;
    while(current != null){
        actualTop += current.offsetTop + current.clientTop;
        current = current.offsetParent;
    }
    return actualTop + 'px';
}
```

## Object as PropType<>

例如：将接受的props转化为booksType类型
```
props:{
    books: object ad PropType<booksType>
}
```

## html 标签属性的标准写法为 name="value" 

• class='top-tips'    //  不规范
• class  =  "top-tips"  //  不规范 

##  Vue privider 和 inject

Vue3的概念
[深入理解组件](https://v3.cn.vuejs.org/guide/component-provide-inject.html#%E5%A4%84%E7%90%86%E5%93%8D%E5%BA%94%E6%80%A7)

## promise.all 让多个await 并行
```js
const res = await Promise.all([api.getViewData({}), api.getBrandCQuc(param)]);

this.formData = {
  viewData: res[0],
  data: res[1],
};
```

## el-scrollbar 的使用 

element 其实存在一个隐藏的组件（文档里没有），阅读源码时发现了这个el-scrollbar组件；

参考文章：[Vue的自定义滚动，我用el-scrollbar](https://juejin.cn/post/6844903613924392974)
```html
<el-scrollbar wrap-class="list" wrap-style="color: red;" view-style="font-weight: bold;" view-class="view-box" :native="false">
    <div v-for="value in num" :key="vlaue">
      {{value}}
    </div>
</el-scrollbar>
```
## el-form 的重置按钮
https://blog.csdn.net/weixin_42708208/article/details/106081689 
## 平滑滚动
案例: 页面中经常需要用到平滑滚动

- css
注意: scroll-behavior一定要加在滚动元素上面，如果没有给main加上高度，就会被子div撑大，就不算是滚动元素。
缺点: 不兼容 Safari浏览器
```css
.main{
    scroll-behavior: smooth;
    height: 100vh;
    overflow: scroll;
}
```

- Vue-router滚动行为-平滑滚动
在学习Vue-router时，发现，实际上原理和上面相同，不兼容Safari等浏览器
```js
scrollBehavior (to, from, savedPosition) {
  if (to.hash) {
    return {
      selector: to.hash,
      behavior: 'smooth',
    }
  }
}
```
- 第三方库 - [smoothscroll-polyfill](http://iamdustan.com/smoothscroll/)
test.vue  
```js
// ……
mounted() {
  smoothscroll.polyfill();
},
// ……

this.$refs[`${href}`].scrollIntoView({ behavior: 'smooth' });
```
## git操作
[git reset 和 git revert](https://juejin.cn/post/6844903614767448072)  
> 何必写的这么复杂，无非两点：1 git revert 后多出一条commit ，提醒同事，这里有回撤操作，2 git reset 直接版之前 commit 删掉，非git reset --hard的操作是不会删掉修改代码，如果远程已经有之前代码，需要强推 git push -f

注意：git revert xxx 会回到xxx版本号之前的版本，XXX修改会被抹除。

## el-checkbox-group  v-model 对象数组
场景：在使用```el-checkbox-group```时，发现v-model好像只能绑定数组，而非对象数组。
el-checkbox-group为多选框组
> checkbox-group元素能把多个 checkbox 管理为一组，只需要在 Group 中使用v-model绑定Array类型的变量即可。 el-checkbox 的 label属性是该 checkbox 对应的值，若该标签中无内容，则该属性也充当 checkbox 按钮后的介绍。label与数组中的元素值相对应，如果存在指定的值则为选中状态，否则为不选中。

参考：[方法一](https://blog.csdn.net/z291493823/article/details/108202558)

## v-clickoutside        自定义指令
[Vue.js 自定义指令使用场景及案例](https://segmentfault.com/a/1190000020082673)
## 组件要纯粹
组件尽量纯粹，不要和路由啊，啥啊，之类的关联性太高。
##  el-table
el-table 的 :data数据源为空数组时，会显示 `暂无数据`。
默认的空数据样式可能无法满足我们的个性化需求，这时，我们可以使用插槽的形式。

```html{2,6}
<el-table ref="brand-table" :data="data" >
    <template slot="empty" v-if="!firstClick">
      暂无查询结果，请确认查询的名称和注册人是否正确，您也可以
      <span @click="handleApplyNew" style="color: #4D80F0; cursor: pointer;">添加新品牌</span>
    </template>
    <template slot="empty" v-else>
      请先输入品牌名称或商标注册人进行查询
    </template>
    <el-table-column property="erpBrandId" label="品牌ID" width="138"></el-table-column>
    <el-table-column property="brandName" label="品牌名称" width="336"></el-table-column>
<el-table>
```

## 「vue style」 scoped原理，嵌套情况，v-deep原理
参考：https://juejin.cn/post/6982780540919234573 

- scoped原理 
为了防止样式污染，在一个vue组件中，我们都会加上 scoped，加上scoped到底发生了
案例：brandList 页面有表格，给表格做了样式后，影响了本页面弹窗中的表格，（我一开始以为弹窗中的表格是另外一个页面）


## sessionStorage 
[sessionStorage、localStorage用法总结](https://segmentfault.com/a/1190000020895002) 可以作为页面间传值的一种方式，很便捷。     

1, sessionStorage、localStorage 会将value强行转成string，
> sessionStorage['person'] = obj; 不能这样存储，这样存进去结果是"[object Object]"
```
sessionStorage['person'] = JSON.stringify(obj);

var person = JSON.parse(sessionStorage['person'])
```
2,出于安全考虑，有时候需要不允许用户自行在浏览器控制台自行修改：
```js
 window.addEventListener('storage', (e:any) => {
      sessionStorage.setItem(e.key, e.oldValue);
    });
```
## 面包屑

```html
<template>
  <div class="bread-wrapper">
    <el-breadcrumb separator-class="el-icon-arrow-right">
      <span class="el-breadcrumb__item">您当前所在位置：</span>
      <template v-if="breadcrumbList && breadcrumbList.length > 0">
        <el-breadcrumb-item  v-for="(item,index) in breadcrumbList" :key="'before'+index" separator-class="el-icon-arrow-right">
          <span >{{item.title}}</span>
        </el-breadcrumb-item>
      </template>

      <el-breadcrumb-item v-for="(item,index)  in levelList" :key="index" separator-class="el-icon-arrow-right">
        <router-link v-if="item.path == $route.matched[0].path" :to="item.path" >
          {{item.title}}
        </router-link>
        <router-link v-else :to="item.path" class="no-redirect" >{{item.title}}</router-link>
      </el-breadcrumb-item>
    </el-breadcrumb>
  </div>
</template>

<script lang="ts">
import Vue from 'vue';

interface Bread {
  name?: string
  path?: string
  title?: string
}

export default Vue.extend({
  data() {
    return {
      levelList: [] as Bread[],
      breadcrumbList: [] as Bread[],
    };
  },
  watch: {
    $route: {
      handler() {
        this.getBreadcrumb();
      },
      immediate: true,
    },
  },
  methods: {
    getBreadcrumb() {
      const { meta } = (this.$route as any);
      if (meta.useAuthBread) {
        const { breadcrumbList } = meta;
        this.levelList = breadcrumbList;
      }
    },
  },
  created() {
    this.getBreadcrumb();
  },
});
</script>


```


```js
import { RouteConfig } from 'vue-router';
import Layout from '@/views/Layout.vue';

type BreadCrumb = {
  /* 点击跳转路径 */
  path: string;
  /* 展示文字 */
  title: string;
  /* 路由名称 */
  name?: string;
  /* 点击埋点 */
  clstag?: string;
}

const baseBreadcrumb: BreadCrumb[] = [{
  path: '/',
  title: '店铺管理',
  name: 'shopManage',
  clstag: '',
}];

const popRoutes: RouteConfig = {
  path: '/',
  name: 'Pop',
  component: Layout,
  meta: {},
  redirect: '/brandList',
  children: [{
    path: '/brandList',
    name: 'BrandList',
    component: () => import(
      /* webpackChunkName: "site/pop/list" */
      '@/views/BrandList.vue'
    ),
    meta: {
      breadcrumbList: [...baseBreadcrumb, {
        path: '/brandList',
        title: '品牌管理',
        name: 'BrandList',
      }],
      title: '品牌管理',
      useAuthBread: true,
    },
    props: true,
  }, {
    path: '/brandEdit',
    name: 'BrandEdit',
    component: () => import(
      /* webpackChunkName: "site/pop/brandEdit" */
      '@/views/BrandEdit.vue'
    ),
    meta: {
      breadcrumbList: [...baseBreadcrumb, {
        path: '/brandEdit',
        title: '添加品牌',
        name: 'BrandEdit',
      }],
      title: '添加品牌',
      useAuthBread: true,
    },
    props: true,
  }, {
    path: '/brandView',
    name: 'BrandView',
    component: () => import(
      /* webpackChunkName: "site/pop/brandView" */
      '@/views/BrandView.vue'
    ),
    meta: {
      breadcrumbList: [...baseBreadcrumb, {
        path: '/brandView',
        title: '查看品牌信息',
        name: 'BrandView',
      }],
      title: '查看品牌信息',
      useAuthBread: true,
    },
    props: true,
  }],
};

export default popRoutes;

```


