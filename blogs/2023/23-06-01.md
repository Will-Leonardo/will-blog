---
title: typescript 常见手写实现
date: 2023-06-01
categories: 
 - TypeScript
---
<Boxx type='tip' />

> typescript 中有很多内置工具类型，掌握这些工具类型的实现，也可以方便记忆工具类型的使用和功能。

## Pick

:strawberry: 前置知识： 
1. type的作用就是给类型起一个新名字；
2. Pick 是工具类型，用于从一个对象中选取部分属性并创建一个新的类型；


### Pick的应用场景

学习一个知识时，我们有时候可以先了解它的有什么用，再去了解具体实现，:smile:

> 通常情况下，我们使用 Pick 来创建一个新的类型，该类型只包含我们需要的属性，而不是整个对象。这在编写类型安全的代码时非常有用，因为它可以帮助我们避免意外地访问或修改不需要的属性。

例如，假设我们有一个名为 Person 的接口，它包含 name、age 和 address 属性：

```typescript
interface Person {
  name: string;
  age: number;
  address: string;
}
```
现在，假设我们只需要使用 name 和 age 属性来创建一个新的类型，我们可以使用 Pick 工具类型来实现：

```typescript
type PersonNameAndAge = Pick<Person, 'name' | 'age'>;
```


### 手写实现Pick

1. 定义一个泛型类型 Pick，它接受两个参数，一个是原始类型 T，另一个是需要选取的属性 K。
```typescript
type Pick<T, K extends keyof T> = ???
```
2. 在 Pick 类型中，我们需要使用 keyof 关键字来获取原始类型 T 的所有属性名，并将其限制为 K 类型的子集。
```typescript
type Pick<T, K extends keyof T> = {
  [P in K]: T[P];
}
```
3. 在 Pick 类型中，我们需要使用映射类型来遍历 K 类型的所有属性名，并将它们映射到原始类型 T 中对应的属性值。

4. 最终，我们可以使用 Pick 工具类型来创建一个新的类型，该类型只包含原始类型 T 中指定的属性。

```typescript
interface Person {
  name: string;
  age: number;
  address: string;
}

type PersonNameAndAge = Pick<Person, 'name' | 'age'>;

```

::: details keyof的使用
keyof的作用是用来遍历ts中某些类型的属性，例如对象类型，接口类型，类等

```
interface response {
  data: [];
  code: number;
  location: string
}
type keys = keyof response 
// keyof response返回的是一个字符串组成字面量类型，即等价于：
// type keys = 'data' | 'code' | 'location'

let obj = {
  data: [],
  code: 200,
  location: '中国'
}

// keyof 作用于类型，不能用于变量

type newObj = keyof typeof obj // 这样先将变量转化为类型，再使用keyof即可

```
::: 

## Exclude

:strawberry: 前置知识： 
1. keyof Person 是一个索引类型，它表示 Person 接口的所有属性名的联合类型；例如，如果 Person 接口包含 name、age 和 address 属性，那么 keyof Person 将会是 'name' | 'age' | 'address' 类型
2. Exclude 是一个工具类型，用于从一个类型中排除指定的类型并创建一个新的类型

```typescript

type MyExclude<T, U> = T extends U ? never : T;

type Person = {
  name: string;
  age: number;
  address: string;
};

type PersonWithoutName = Pick<Person, MyExclude<keyof Person, 'name'>>;

```


为什么要返回 never 呢？

因为 never 代表的是永远不可能出现的类型，相当于一个空集合。这样，在使用 Exclude 操作符时，我们就可以将 T 中与 K 相同的类型排除掉，从而得到一个新的类型


## Partial

Partial 是 TypeScript 内置的一个类型操作符，它用于将某个类型中每个属性设置为可选属性，这表示这些属性的值可以是 undefined 或者省略。

```TypeScript
type Partial<T> = {
  [P in keyof T]?: T[P];
};

```


## Omit

Omit 是 TypeScript 的一种类型操作符，用于从类型 T 中删去指定的属性 K

```TypeScript
type Omit<T, K> = Pick<T, Exclude<keyof T, K>>;
```


## Readonly

Readonly 是 TypeScript 内置的一个类型操作符，它用于将某个类型中每个属性设置为只读属性，这表示这些属性的值不能被修改。

```TypeScript

type Readonly<T> = {
  readonly [P in keyof T]: T[P];
};

```

## Required

```TypeScript
type Required<T> = {
  [P in keyof T]-?: T[P];
};
```

